# 124 [二叉树中的最大路径和](https://leetcode-cn.com/problems/binary-tree-maximum-path-sum/) ppt 演讲



### 第 1 页

大家好，这里是「力扣」视频题解第 124 题：[二叉树中的最大路径和](https://leetcode-cn.com/problems/binary-tree-maximum-path-sum/) 。



### 第 2 页

我们先来看路径是什么样子的。

直观的来说，就像这样，从 d 出发，经过 b a 到达 c 。

也可以是从 f 出发，经过 c 到达 g 。

或者像这样干脆只有一个节点。



### 第 3 页

那么路径和二叉树的数据结构有什么区别，

二叉树中的一个节点，向上会被一个父节点连接，左右连接两个子节点

而路径在一个节点上只有来和去两个方向

所以这里是让我们想办法进行一个 3 选 2 ，3 选 2 一共只有 3 种情况。

分别是左加右，左加上，右加上。



## 第 3 页

那么路径和二叉树的数据结构有什么区别，

二叉树中的一个节点，向上会被一个父节点连接，左右连接两个子节点

而路径在一个节点上只有来和去两个方向

所以这里是让我们想办法进行一个 3 选 2 ，3 选 2 一共只有 3 种情况。

分别是左加右，左加上，右加上。



### 第 4 页

我们实际走一走看。

假设我们自底向上出发。

当我们走到一个父节点，告诉父节点自己的值是多少，父节点会和另一边节点比较。

选择更大的一边，继续向上走。

否则，不往上走了，拐弯去另一边。



### 第 5 页

情况摸清楚了，解题思路也就有了。

我们考虑一个最基本的二叉树单元，……

 

### 第 6 页

选择「左」还是「右」 ，也就是 b + a 和 c + a 怎么选。

我们设计一个函数，它可以计算得出一个节点通往下方的最大路径和。

把 a 传进去，现在需要知道 b 和 c 通往下方的最大路径和，只需要对 b 和 c 递归，拿到返回值，然后选择较大的值，再加上 a 的值，这样就得到了 a 通往下方的最大路径和。



请注意，

因为整个二叉树的最大路径和不一定经过根节点，所以答案并不是根节点的返回值。

这里我们就需要一个能够记录所有路径和中最大值的全局变量，就称它为全局最大和。

在计算出来返回值之后，马上把它更新到全局最大和。



### 第 7 页

选择「左中右」，也就是 b + a + c 的情况。

非常简单，当我们得到 b 和 c 的返回值之后，只需要连同自己加到一起，就好了。

然后也要把它更新到全局最大和。



### 第 8 页

如果节点的值是负数怎么办

为求最大，负数应该尽可能的舍弃。

使用 max 函数，就可以在负数和 0 之间选择 0，也就相当于舍弃了负数。



但是请注意，在我们的函数中，无论是选择向上，还是连接 b 和 c，都要经过 a ，所以 a 不能舍弃。



那么我们要怎么舍弃负数的 a ？

还记得我们的全局最大和吗，全局最大和只记录最大的和，加了负数的 a ，路径会变小，是不会更新到全局最大和里的，也就被舍弃了。



如果用例全都是负数，我们的算法会不会有问题。

来看这个全是 -1 的用例。当他发现左右子节点都是 -1 ，就把他们舍弃了，但是自己不能舍弃，所以返回值是 -1 。

把 -1 更新到全局最大和，能不能成功？

这里又涉及到另一个细节，全局最大和的初始值，可不能是 0 哦，应该是 INT_MIN （-2^31）。





### 第 9 页

思路确定了，我们把它变成代码。

先定义递归函数，参数中除了节点 root，还要带上一个引用的全局最大和 val。

先写递归终点，当 root 为 空时，返回 0 。

左边 left，递归一下，使用 max 舍弃 0 。

右边 right，递归一下，使用 max 舍弃 0 。

拿到返回值之后，

计算左中右 lmr。

计算返回值 ret。

更新到全局最大和，val = max(val, max(lmr, ret)) 。

最后返回 ret。

接下来我们在到入口函数调用一下，

完成。



### 第 10 页

代码写好了，跑个例子看看。

1. 首先，传入的是 -10 这个节点，他需要先递归左子节点 9 。
2. 9 是叶子节点，它的左右子节点是空，所以左右的值都是 0 ，得到返回值是 9 ，连接左中右的值是 9，更新全局最大和 9 。返回。
3. 再看 -10 的右子节点 20 ，他会递归计算 15 和 7 。情况跟 9 是一样的。
4. 跑完之后，看到全局最大和已经更新到了 15 。现在 20 这个节点的左右子节点值已经确定了，我们计算一下。
5. 选择左边，15 + 20 = 35，选择右边，7 + 20 = 27。左中右，15 + 20 + 7 = 42。返回值就选择 35，全局最大和更新到 42。返回。
6. 现在 -10 这个节点的左右子节点的返回值都确定了，来计算一下
7. 选择左边 -1，选择右边 25，左中右 34。返回值选择 25，全局最大和不用更新。
8. 执行完毕，最后得出答案 42 。



好了，这道题的讲解就到这里了，感谢观看。