# 124 [二叉树中的最大路径和](https://leetcode-cn.com/problems/binary-tree-maximum-path-sum/) ppt 演讲



### 第 1 页

大家好，这里是「力扣」视频题解第 124 题：[二叉树中的最大路径和](https://leetcode-cn.com/problems/binary-tree-maximum-path-sum/) 。

先来读一下题，

看一下给出的示例，

### 第 2 页

我们分析一下题意，首先看看题目给出路径的定义。

本题中，路径被定义为一条从树中任意节点出发，达到任意节点的序列。该路径**至少包含一个**节点，且不一定经过根节点。

如果感觉心里没什么概念，可以画个图参考一下。

比如说，有可能是 dbac ，或者不经过根节点，像 fcg 这样，还有可能单独一个节点。



### 第 3 页

接下来我们研究一下，这个路径和二叉树的数据结构有什么样的关系呢，

二叉树是由一个父节点和左右两个子节点组成

而路径在一个节点上只有来和去两个方向

所以这里是让我们想办法进行一个 3 选 2 ，3 选 2 一共只有 3 种情况。

分别是不选上，不选左，不选右。

### 第 4 页

我们实际走一走看。

假设我们自底向上出发。

当我们走到一个父节点，会和另一边节点比较。

要么是我们这条路路径和大，要么是另一边。

选择更大的一边，继续向上走。

否则，不往上走了，拐弯去另一边。



### 第 5 页

情况我们已经搞清楚了，现在考虑解决方案。

我们考虑一个最基本的二叉树单元，

 

### 第 6 页

先处理情况 2 和 3 ，也就是 a 确定了，b 和 c 怎么选。

这个就很简单了，比较一下 a + b 和 a + c ，选择一个大的作为返回值，表示我选择了这条路。

这个返回值的意义就是，通过 a 节点，向下出发，路径的最大和。

如果 b 下面还有子树，怎么办。只需要对 b 递归，那返回值就是 b 通向下方路径的最大和。

这里注意一下，

因为最大路径和有可能是不经过根节点的，所以答案并不是根节点的返回值。

我们需要一个全局最大和来保存。

在返回之前，我们还需要把这个向下路径最大和更新到全局最大和。



### 第 7 页

再看情况 1，选择 b 和 c。

当我们递归得到 b 和 c 的返回值之后，只需要相加，就能得到 b + a + c 的值。

然后更新到全局最大和。



### 第 8 页

如果有负数怎么办

本能的想一下，如果多走一步不增加，反而减少了，那我为什么要走呢。

所以这里我们尽可能的舍弃负数节点。

使用 max(0,x) 就可以把负数变成 0 ，路径和没有变化，就相当于没有选择他了。



但是注意，在我们计算的时候，无论是选择向上，还是连接 b 和 c，都要经过 a ，所以 a 不能舍弃。



那么在什么时候舍弃 a 呢，还记得我们的全局最大和吗，全局最大和只更新更大的，加了负数的 a 变小了是更新不到全局最大和里去的。



如果用例全都是负数会不会有问题，来看这个全是 -1 的用例。

当他发现左右子节点都是 -1 ，就把他们舍弃了，但是自己不能舍弃，所以返回值应该是 -1 。

把 -1 更新到全局最大和。

所以这里又涉及到一个细节，全局最大和的初始值，不能是 0 哦，应该是 int 类型的最小值才对。





### 第 9 页

思路确定了，我们把它变成代码。

首先这里先定义递归函数，参数中除了节点，还要带上一个引用的全局最大和 val。

先写递归终点，当 root 为 空时，返回 0 。

递归求左子节点，求右子节点，舍弃 0 。

拿到返回值之后，就可以计算了。

算一下连接左右子节点的路径和，左中右 等于 中 加 左 加 右。

算一下返回值，返回值 等于 中 加上 max 左 或 右。

更新到全局最大和，val 等于 max 左中右 或 返回值。

返回。

完成。

接下来我们从入口函数调用一下，

初始化全局最大和，调用，返回。

完成。



### 第 10 页

找个例子运行一下。

1. 首先，传入的是 -10 这个节点，他需要先递归左子节点 9 。
2. 9 是叶子节点，它的左右子节点是空，所以左右的值都是 0 ，得到返回值是 9 ，连接左中右的值是 9，更新全局最大和 9 。返回。
3. 再看 -10 的右子节点 20 ，他会递归计算 15 和 7 。情况跟 9 是一样的，跑完之后，看到全局最大和已经更新到了 15 。
4. 现在 20 这个节点的左右子节点值已经确定了，我们计算一下，。
5. 选择左边，15 + 20 = 35，选择右边，7 + 20 = 27。左中右，15 + 20 + 7 = 42。返回值就选择 35，全局最大和更新到 42。返回。
6. 现在 -10 这个节点的左右子节点的返回值都确定了，来计算一下，选择左边 -1，选择右边 25，左中右 34。返回值选择 25，全局最大和不用更新。
7. 执行完毕，最后得出答案 42 。



好了，这道题的讲解就到这里了，感谢观看。